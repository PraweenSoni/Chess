<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Profile - Chess Lobby</title>
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
</head>

<body class="bg-zinc-900 text-white">
  <div class="flex h-screen">
    <aside class="w-64 bg-zinc-800 p-5 flex flex-col gap-4">
      <div class="flex items-center mb-4">
        <img src="/assets/images/logoWhite.png" class="h-10 w-10 mr-2" alt="">
        <h1 class="text-xl font-bold text-white">Chess Lobby</h1>
      </div>
      <nav class="flex flex-col gap-3">
        <a href="/dashboard" class="hover:bg-zinc-700 p-2 rounded">Home</a>
        <!-- <a href="/watch" class="hover:bg-zinc-700 p-2 rounded">Watch Games</a> -->
        <a href="/create" class="hover:bg-zinc-700 p-2 rounded">Create Room</a>
        <a href="/world" class="hover:bg-zinc-700 p-2 rounded">World</a>
        <a href="/leaderboard" class="hover:bg-zinc-700 p-2 rounded">Leaderboard</a>
        <a href="/profile" class="bg-zinc-700 p-2 rounded font-semibold text-green-400">Profile</a>
        <a href="/notifications" class="hover:bg-zinc-700 p-2 rounded">Notifications</a>
        <a href="/Settings" class="hover:bg-zinc-700 p-2 rounded">Settings</a>
        <% if(user.isLoggedIn) { %>
          <a href="/logout" class="hover:bg-zinc-700 p-2 rounded">Logout</a>
          <%} else { %>
            <a href="/login" class="hover:bg-zinc-700 p-2 rounded">Login</a>
            <a href="/signup" class="hover:bg-zinc-700 p-2 rounded">Sign Up</a>
            <%} %>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 p-8 overflow-y-auto">
      <div class="flex items-center gap-6 mb-8">
        <img src="/assets/images/logo.png" alt="Avatar"
          class="w-24 h-24 rounded-full border-4 border-green-500 bg-white" />
        <div>
          <h2 class="text-2xl font-bold">
            <%= user.name %>
          </h2>
          <% const createdAt=new Date(user.createdAt); const formattedDate=createdAt.toLocaleDateString('en-US',
            {month: 'long' , day: 'numeric' , year: 'numeric' }); %>
            <p class="text-gray-300">
              <% if (user.country && countryMap[user.country]) { %>
                <%= countryMap[user.country].flag %>
                  <span class="ml-1">
                    <%= countryMap[user.country].name %>
                  </span>
                  <% } else { %>
                    Country not specified
                  <% } %> â€¢ Member since <%= formattedDate %>
            </p>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
        <!-- Stats Card -->
        <div class="bg-zinc-800 p-5 rounded shadow">
          <h3 class="text-lg font-semibold mb-4">Stats</h3>
          <div class="space-y-2">
            <p><strong>Rating:</strong>
              <%= user.rating %>
            </p>
            <p><strong>Likes:</strong>
              <%= user.like %>
            </p>
            <p><strong>Games Played:</strong>
              <%= user.gamesPlayed %>
            </p>
            <p><strong>Wins:</strong>
              <%= user.gameWins %>
            </p>
            <p><strong>Losses:</strong>
              <%= user.gamesPlayed - user.gameWins %>
            </p>
            <p><strong>Rank:</strong> #<%= user.rank %> in India</p>
          </div>
        </div>

        <!-- Edit Profile -->
        <div class="bg-zinc-800 p-5 rounded shadow">
          <h3 class="text-lg font-semibold mb-4">Update Info</h3>
          <form class="space-y-3" action="/profile" method="POST">
            <label for="usernameInp" class="block text-sm font-medium text-white mb-2">
              Your Username:
            </label>
            <input type="text" id="usernameInp" placeholder="<%= user.name ? user.name : 'Username' %>"
              class="w-full p-2 rounded focus:outline-none focus:ring-2  bg-zinc-700 border border-zinc-600 text-white focus:ring-green-500 focus:border-green-500" />
            <!-- <input type="text" name="country" id="country" required
              placeholder="<%= user.country ? user.country : 'Country' %>" class="w-full p-2 rounded bg-zinc-700 border border-zinc-600 text-white" /> -->
            <!-- <div>
              <label for="country" class="block text-sm font-medium text-white mb-2">
                Choose your country:
              </label>
              <select id="country" name="country" required class="block w-full p-2 border rounded shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500  bg-zinc-700 border-zinc-600 text-white">
                <option value="in">ğŸ‡®ğŸ‡³ India</option>
                <option value="us">ğŸ‡ºğŸ‡¸ United States</option>
                <option value="gb">ğŸ‡¬ğŸ‡§ United Kingdom</option>
                <option value="ca">ğŸ‡¨ğŸ‡¦ Canada</option>
                <option value="au">ğŸ‡¦ğŸ‡º Australia</option>
                <option value="de">ğŸ‡©ğŸ‡ª Germany</option>
                <option value="fr">ğŸ‡«ğŸ‡· France</option>
                <option value="jp">ğŸ‡¯ğŸ‡µ Japan</option>
                <option value="cn">ğŸ‡¨ğŸ‡³ China</option>
                <option value="ru">ğŸ‡·ğŸ‡º Russia</option>
                <option value="br">ğŸ‡§ğŸ‡· Brazil</option>
                <option value="za">ğŸ‡¿ğŸ‡¦ South Africa</option>
                <option value="it">ğŸ‡®ğŸ‡¹ Italy</option>
                <option value="mx">ğŸ‡²ğŸ‡½ Mexico</option>
                <option value="es">ğŸ‡ªğŸ‡¸ Spain</option>
                <option value="kr">ğŸ‡°ğŸ‡· South Korea</option>
                <option value="sa">ğŸ‡¸ğŸ‡¦ Saudi Arabia</option>
                <option value="tr">ğŸ‡¹ğŸ‡· Turkey</option>
                <option value="ar">ğŸ‡¦ğŸ‡· Argentina</option>
                <option value="id">ğŸ‡®ğŸ‡© Indonesia</option>
                <option value="nl">ğŸ‡³ğŸ‡± Netherlands</option>
                <option value="se">ğŸ‡¸ğŸ‡ª Sweden</option>
                <option value="ch">ğŸ‡¨ğŸ‡­ Switzerland</option>
                <option value="ua">ğŸ‡ºğŸ‡¦ Ukraine</option>
                <option value="pl">ğŸ‡µğŸ‡± Poland</option>
                <option value="no">ğŸ‡³ğŸ‡´ Norway</option>
                <option value="bd">ğŸ‡§ğŸ‡© Bangladesh</option>
                <option value="pk">ğŸ‡µğŸ‡° Pakistan</option>
                <option value="ng">ğŸ‡³ğŸ‡¬ Nigeria</option>
                <option value="th">ğŸ‡¹ğŸ‡­ Thailand</option>
                <option value="my">ğŸ‡²ğŸ‡¾ Malaysia</option>
                <option value="sg">ğŸ‡¸ğŸ‡¬ Singapore</option>
                <option value="nz">ğŸ‡³ğŸ‡¿ New Zealand</option>
                <option value="eg">ğŸ‡ªğŸ‡¬ Egypt</option>
                <option value="cz">ğŸ‡¨ğŸ‡¿ Czech Republic</option>
                <option value="fi">ğŸ‡«ğŸ‡® Finland</option>
                <option value="dk">ğŸ‡©ğŸ‡° Denmark</option>
                <option value="il">ğŸ‡®ğŸ‡± Israel</option>
                <option value="ph">ğŸ‡µğŸ‡­ Philippines</option>
                <option value="ve">ğŸ‡»ğŸ‡ª Venezuela</option>
                <option value="cl">ğŸ‡¨ğŸ‡± Chile</option>
                <option value="ie">ğŸ‡®ğŸ‡ª Ireland</option>
                <option value="at">ğŸ‡¦ğŸ‡¹ Austria</option>
                <option value="be">ğŸ‡§ğŸ‡ª Belgium</option>
                <option value="gr">ğŸ‡¬ğŸ‡· Greece</option>
                <option value="pt">ğŸ‡µğŸ‡¹ Portugal</option>
                <option value="ro">ğŸ‡·ğŸ‡´ Romania</option>
                <option value="hu">ğŸ‡­ğŸ‡º Hungary</option>
                <option value="hu">ğŸŒ Other</option>
              </select>
            </div> -->
            <label for="country" class="block text-sm font-medium text-gray-200 mb-2">
              Choose a country:
            </label>

            <select name="country" id="country" required
              class="w-full p-2 rounded bg-zinc-700 border border-zinc-600 text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
              <option disabled selected>Loading countries...</option>
            </select>

            <button type="submit" class="w-full bg-green-600 hover:bg-green-700 p-2 rounded">Update Profile</button>
          </form>
        </div>
      </div>

      <div>
        <h3 class="text-lg font-semibold mb-4">Recent Games<span
            class="ml-2 px-1 font text-black bg-green-400 rounded-2xl">Comming Soon</span></h3>
        <div class="space-y-3">
          <!-- Game Card -->
          <div class="bg-zinc-800 p-4 rounded shadow flex justify-between items-center">
            <div>
              <p class="font-semibold">Praween vs John</p>
              <p class="text-sm text-gray-400">Result: Win â€¢ 5 min Blitz</p>
            </div>
            <span class="text-green-500 font-bold">+10</span>
          </div>
          <div class="bg-zinc-800 p-4 rounded shadow flex justify-between items-center">
            <div>
              <p class="font-semibold">Praween vs Alice</p>
              <p class="text-sm text-gray-400">Result: Loss â€¢ 10 min Rapid</p>
            </div>
            <span class="text-red-500 font-bold">-5</span>
          </div>
          <!-- More games... -->
        </div>
      </div>
    </main>
  </div>
  <script>
    const countries = [
      { code: "us", name: "United States", flag: "ğŸ‡ºğŸ‡¸" },
      { code: "gb", name: "United Kingdom", flag: "ğŸ‡¬ğŸ‡§" },
      { code: "in", name: "India", flag: "ğŸ‡®ğŸ‡³" },
      { code: "ca", name: "Canada", flag: "ğŸ‡¨ğŸ‡¦" },
      { code: "au", name: "Australia", flag: "ğŸ‡¦ğŸ‡º" },
      { code: "de", name: "Germany", flag: "ğŸ‡©ğŸ‡ª" },
      { code: "fr", name: "France", flag: "ğŸ‡«ğŸ‡·" },
      { code: "jp", name: "Japan", flag: "ğŸ‡¯ğŸ‡µ" },
      { code: "cn", name: "China", flag: "ğŸ‡¨ğŸ‡³" },
      { code: "ru", name: "Russia", flag: "ğŸ‡·ğŸ‡º" },
      { code: "br", name: "Brazil", flag: "ğŸ‡§ğŸ‡·" },
      { code: "za", name: "South Africa", flag: "ğŸ‡¿ğŸ‡¦" },
      { code: "it", name: "Italy", flag: "ğŸ‡®ğŸ‡¹" },
      { code: "mx", name: "Mexico", flag: "ğŸ‡²ğŸ‡½" },
      { code: "es", name: "Spain", flag: "ğŸ‡ªğŸ‡¸" },
      { code: "kr", name: "South Korea", flag: "ğŸ‡°ğŸ‡·" },
      { code: "sa", name: "Saudi Arabia", flag: "ğŸ‡¸ğŸ‡¦" },
      { code: "tr", name: "Turkey", flag: "ğŸ‡¹ğŸ‡·" },
      { code: "ar", name: "Argentina", flag: "ğŸ‡¦ğŸ‡·" },
      { code: "id", name: "Indonesia", flag: "ğŸ‡®ğŸ‡©" },
      { code: "nl", name: "Netherlands", flag: "ğŸ‡³ğŸ‡±" },
      { code: "se", name: "Sweden", flag: "ğŸ‡¸ğŸ‡ª" },
      { code: "ch", name: "Switzerland", flag: "ğŸ‡¨ğŸ‡­" },
      { code: "ua", name: "Ukraine", flag: "ğŸ‡ºğŸ‡¦" },
      { code: "pl", name: "Poland", flag: "ğŸ‡µğŸ‡±" },
      { code: "no", name: "Norway", flag: "ğŸ‡³ğŸ‡´" },
      { code: "bd", name: "Bangladesh", flag: "ğŸ‡§ğŸ‡©" },
      { code: "pk", name: "Pakistan", flag: "ğŸ‡µğŸ‡°" },
      { code: "ng", name: "Nigeria", flag: "ğŸ‡³ğŸ‡¬" },
      { code: "th", name: "Thailand", flag: "ğŸ‡¹ğŸ‡­" },
      { code: "my", name: "Malaysia", flag: "ğŸ‡²ğŸ‡¾" },
      { code: "sg", name: "Singapore", flag: "ğŸ‡¸ğŸ‡¬" },
      { code: "nz", name: "New Zealand", flag: "ğŸ‡³ğŸ‡¿" },
      { code: "eg", name: "Egypt", flag: "ğŸ‡ªğŸ‡¬" },
      { code: "cz", name: "Czech Republic", flag: "ğŸ‡¨ğŸ‡¿" },
      { code: "fi", name: "Finland", flag: "ğŸ‡«ğŸ‡®" },
      { code: "dk", name: "Denmark", flag: "ğŸ‡©ğŸ‡°" },
      { code: "il", name: "Israel", flag: "ğŸ‡®ğŸ‡±" },
      { code: "ph", name: "Philippines", flag: "ğŸ‡µğŸ‡­" },
      { code: "ve", name: "Venezuela", flag: "ğŸ‡»ğŸ‡ª" },
      { code: "cl", name: "Chile", flag: "ğŸ‡¨ğŸ‡±" },
      { code: "ie", name: "Ireland", flag: "ğŸ‡®ğŸ‡ª" },
      { code: "at", name: "Austria", flag: "ğŸ‡¦ğŸ‡¹" },
      { code: "be", name: "Belgium", flag: "ğŸ‡§ğŸ‡ª" },
      { code: "gr", name: "Greece", flag: "ğŸ‡¬ğŸ‡·" },
      { code: "pt", name: "Portugal", flag: "ğŸ‡µğŸ‡¹" },
      { code: "ro", name: "Romania", flag: "ğŸ‡·ğŸ‡´" },
      { code: "hu", name: "Hungary", flag: "ğŸ‡­ğŸ‡º" },
      { code: "co", name: "Colombia", flag: "ğŸ‡¨ğŸ‡´" },
      { code: "vn", name: "Vietnam", flag: "ğŸ‡»ğŸ‡³" }
    ];

    // EJS will inject the saved country code or blank
    const userCountry = "<%= user.country || '' %>";
    const select = document.getElementById("country");
    select.innerHTML = ""; // clear the loading placeholder

    countries.forEach(({ code, name, flag }) => {
      const opt = document.createElement("option");
      opt.value = code;
      opt.textContent = `${flag} ${name}`;
      if (code === userCountry) opt.selected = true;
      select.appendChild(opt);
    });
  </script>

</body>

</html>